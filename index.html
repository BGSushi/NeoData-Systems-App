<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NeoData Systems</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e0f2f7; /* Light blue background as seen in PDF */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff; /* White background for the main container */
            border-radius: 1rem; /* Rounded corners */
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 900px; /* Adjust based on preferred layout width */
            padding: 2.5rem;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative; /* For absolute positioning of dialogs */
        }
        .page {
            display: none; /* Hidden by default */
            width: 100%;
            flex-direction: column;
            align-items: center;
        }
        .page.active {
            display: flex; /* Show active page */
        }
        .input-group {
            width: 100%;
            margin-bottom: 1.5rem;
        }
        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #4a5568; /* Darker text color */
        }
        .input-group input[type="text"],
        .input-group input[type="password"],
        .input-group input[type="date"],
        .input-group input[type="time"],
        .input-group textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #cbd5e0; /* Light grey border */
            border-radius: 0.5rem; /* Slightly rounded corners for inputs */
            font-size: 1rem;
            color: #2d3748; /* Dark text for inputs */
            box-sizing: border-box;
        }
        .button-primary, .button-secondary, .button-danger {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem; /* More rounded buttons */
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        .button-primary {
            background-color: #4CAF50; /* Green */
            color: white;
        }
        .button-primary:hover {
            background-color: #45a049;
            transform: translateY(-1px);
        }
        .button-secondary {
            background-color: #60a5fa; /* Blue */
            color: white;
        }
        .button-secondary:hover {
            background-color: #3b82f6;
            transform: translateY(-1px);
        }
        .button-danger {
            background-color: #ef4444; /* Red */
            color: white;
        }
        .button-danger:hover {
            background-color: #dc2626;
            transform: translateY(-1px);
        }

        /* Specific styles for the login page */
        #login-page .logo-container {
            margin-bottom: 2rem;
            text-align: center;
        }
        #login-page .logo-container img {
            max-width: 150px; /* Adjust logo size */
            margin-bottom: 1rem;
        }
        #login-page .form-container {
            width: 100%;
            max-width: 350px;
            background-color: #f7fafc; /* Light grey background for login form */
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.06);
            margin-bottom: 2rem;
        }
        #login-page .button-group {
            display: flex;
            justify-content: space-around;
            width: 100%;
            max-width: 350px;
        }
        #login-page .button-group button {
            flex-grow: 1;
            margin: 0 10px; /* Spacing between buttons */
        }

        /* Main menu styles */
        #main-menu .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1.5rem;
            width: 100%;
            max-width: 600px;
        }
        #main-menu .menu-button {
            background-color: #60a5fa; /* Blue for menu buttons */
            color: white;
            padding: 2rem 1rem;
            border-radius: 1rem;
            font-size: 1.25rem;
            font-weight: 700;
            text-align: center;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-in-out;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.1);
        }
        #main-menu .menu-button:hover {
            background-color: #3b82f6;
            transform: translateY(-2px);
        }

        /* Form page general styles */
        .form-page-header {
            width: 100%;
            text-align: center;
            margin-bottom: 2rem;
            font-size: 2rem;
            font-weight: 700;
            color: #2d3748;
        }
        .form-content {
            width: 100%;
            max-width: 500px; /* Max width for forms */
        }
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
            width: 100%;
            max-width: 500px;
        }
        .form-actions.justify-center {
            justify-content: center;
        }

        /* Confirmation dialog styles */
        .dialog-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            display: none; /* Hidden by default */
        }
        .dialog-overlay.active {
            display: flex;
        }
        .dialog-content {
            background: white;
            padding: 2.5rem;
            border-radius: 1rem;
            text-align: center;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            width: 90%;
        }
        .dialog-content p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            color: #2d3748;
        }
        .dialog-actions {
            display: flex;
            justify-content: space-around;
            gap: 1rem;
        }
        .dialog-actions button {
            flex: 1;
        }

        /* Utility classes */
        .text-center { text-align: center; }
        .mb-8 { margin-bottom: 2rem; }
        .text-3xl { font-size: 1.875rem; /* 30px */ }
        .font-bold { font-weight: 700; }
        /* User ID display - Removed as not applicable for local storage */
        /* Table styles for display results */
        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
            background-color: white;
            border-radius: 0.5rem;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .results-table th, .results-table td {
            padding: 0.75rem;
            border-bottom: 1px solid #e2e8f0;
            text-align: left;
        }
        .results-table th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
        }
        .results-table tr:last-child td {
            border-bottom: none;
        }
        .results-table tr:hover {
            background-color: #edf2f7;
        }
        /* Style for individual update buttons */
        .input-with-button {
            display: flex;
            align-items: flex-end; /* Align button to bottom of input */
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        .input-with-button > div {
            flex-grow: 1;
        }
        .input-with-button button {
            flex-shrink: 0; /* Prevent button from shrinking */
            padding: 0.5rem 1rem; /* Smaller padding for individual buttons */
            font-size: 0.875rem; /* Smaller font size */
            border-radius: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo Header -->
        <div class="absolute top-4 left-4">
            <img src="https://placehold.co/100x40/60a5fa/ffffff?text=NeoData+Systems" alt="NeoData Systems Logo" class="w-24 h-auto rounded-lg">
        </div>

        <!-- Login Page (Page 1) -->
        <div id="login-page" class="page active">
            <div class="logo-container">
                <img src="https://placehold.co/150x150/e0f2f7/4a5568?text=NeoData+Systems" alt="NeoData Systems Logo" class="rounded-full">
            </div>
            <div class="form-container">
                <h2 class="text-center text-2xl font-bold mb-6 text-gray-800">Iniciar Sesión</h2>
                <div class="input-group">
                    <label for="username">Ingresar Usuario</label>
                    <input type="text" id="username" placeholder="Usuario">
                </div>
                <div class="input-group">
                    <label for="password">Ingresar Contraseña</label>
                    <input type="password" id="password" placeholder="Contraseña">
                </div>
            </div>
            <div class="button-group">
                <button id="login-button" class="button-primary">Ingresar</button>
                <button id="exit-button" class="button-danger">Salir</button>
            </div>
        </div>

        <!-- Main Menu (Page 2) -->
        <div id="main-menu" class="page">
            <h1 class="text-center text-3xl font-bold mb-8 text-gray-800">Menú Principal</h1>
            <div class="menu-grid">
                <button id="btn-alta" class="menu-button">ALTA</button>
                <button id="btn-modificar" class="menu-button">MODIFICAR</button>
                <button id="btn-consulta" class="menu-button">CONSULTA</button>
                <button id="btn-baja" class="menu-button">BAJA</button>
            </div>
            <div class="form-actions justify-center mt-8">
                <button id="main-menu-logout" class="button-danger">Cerrar Sesión</button>
            </div>
        </div>

        <!-- Altas Menu (Page 3) -->
        <div id="altas-menu" class="page">
            <h1 class="text-center text-3xl font-bold mb-8 text-gray-800">Menú Altas</h1>
            <div class="menu-grid">
                <button id="btn-alta-empleado" class="menu-button">Empleado</button>
                <button id="btn-alta-vendedor" class="menu-button">Vendedor</button>
                <button id="btn-alta-cliente" class="menu-button">Cliente</button>
                <button id="btn-alta-libro" class="menu-button">Libro</button>
                <button id="btn-alta-visita" class="menu-button">Visita</button>
            </div>
            <div class="form-actions justify-center mt-8">
                <button id="back-to-main-menu-from-altas" class="button-secondary">Menú Principal</button>
            </div>
        </div>

        <!-- Alta Empleado Page (Page 5) -->
        <div id="alta-empleado-page" class="page">
            <h1 class="form-page-header">Alta Empleado</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="alta-empleado-no">Número Empleado:</label>
                    <input type="text" id="alta-empleado-no" placeholder="Número de empleado (PK)">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-nom">Nombre Empleado:</label>
                    <input type="text" id="alta-empleado-nom" placeholder="Nombre completo del empleado">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-legajo">Legajo:</label>
                    <input type="text" id="alta-empleado-legajo" placeholder="Legajo del empleado">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-dir">Dirección Empleado:</label>
                    <input type="text" id="alta-empleado-dir" placeholder="Dirección del empleado">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-tel">Teléfono Empleado:</label>
                    <input type="text" id="alta-empleado-tel" placeholder="Teléfono del empleado">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-empresa">Empresa Empleado:</label>
                    <input type="text" id="alta-empleado-empresa" placeholder="Empresa a la que pertenece">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-correo">Correo Empleado:</label>
                    <input type="text" id="alta-empleado-correo" placeholder="Correo electrónico del empleado">
                </div>
                <div class="input-group">
                    <label for="alta-empleado-edad">Edad:</label>
                    <input type="text" id="alta-empleado-edad" placeholder="Edad del empleado">
                </div>
            </div>
            <div class="form-actions">
                <button id="register-empleado-button" class="button-primary">Registrar</button>
                <button id="back-to-altas-menu-from-empleado" class="button-secondary">Menú Altas</button>
            </div>
        </div>

        <!-- Alta Vendedor Page (Page 6) -->
        <div id="alta-vendedor-page" class="page">
            <h1 class="form-page-header">Alta Vendedor</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="alta-vendedor-id">ID Vendedor:</label>
                    <input type="text" id="alta-vendedor-id" placeholder="ID del vendedor (PK)">
                </div>
                <div class="input-group">
                    <label for="alta-vendedor-nombre">Nombre Vendedor:</label>
                    <input type="text" id="alta-vendedor-nombre" placeholder="Nombre completo del vendedor">
                </div>
                <div class="input-group">
                    <label for="alta-vendedor-tel">Teléfono Vendedor:</label>
                    <input type="text" id="alta-vendedor-tel" placeholder="Teléfono del vendedor">
                </div>
            </div>
            <div class="form-actions">
                <button id="register-vendedor-button" class="button-primary">Registrar</button>
                <button id="back-to-altas-menu-from-vendedor" class="button-secondary">Menú Altas</button>
            </div>
        </div>

        <!-- Alta Cliente (Not in PDF, but logically needed) -->
        <div id="alta-cliente-page" class="page">
            <h1 class="form-page-header">Alta Cliente</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="alta-cliente-id">ID Cliente:</label>
                    <input type="text" id="alta-cliente-id" placeholder="ID del cliente (PK)">
                </div>
                <div class="input-group">
                    <label for="alta-cliente-nombre">Nombre Cliente:</label>
                    <input type="text" id="alta-cliente-nombre" placeholder="Nombre del cliente">
                </div>
                <div class="input-group">
                    <label for="alta-cliente-direccion">Dirección:</label>
                    <input type="text" id="alta-cliente-direccion" placeholder="Dirección del cliente">
                </div>
                <div class="input-group">
                    <label for="alta-cliente-telefono">Teléfono:</label>
                    <input type="text" id="alta-cliente-telefono" placeholder="Teléfono del cliente">
                </div>
                <div class="input-group">
                    <label for="alta-cliente-correo">Correo:</label>
                    <input type="text" id="alta-cliente-correo" placeholder="Correo electrónico del cliente">
                </div>
            </div>
            <div class="form-actions">
                <button id="register-cliente-button" class="button-primary">Registrar</button>
                <button id="back-to-altas-menu-from-cliente-alta" class="button-secondary">Menú Altas</button>
            </div>
        </div>

        <!-- Alta Libro Page (Page 7) -->
        <div id="alta-libro-page" class="page">
            <h1 class="form-page-header">Alta Libro</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="alta-libro-id">ID Libro:</label>
                    <input type="text" id="alta-libro-id" placeholder="ID del libro (PK)">
                </div>
                <div class="input-group">
                    <label for="alta-libro-titulo">Título:</label>
                    <input type="text" id="alta-libro-titulo" placeholder="Título del libro">
                </div>
                <div class="input-group">
                    <label for="alta-libro-autor">Autor:</label>
                    <input type="text" id="alta-libro-autor" placeholder="Autor del libro">
                </div>
                <div class="input-group">
                    <label for="alta-libro-editorial">Editorial:</label>
                    <input type="text" id="alta-libro-editorial" placeholder="Editorial del libro">
                </div>
                <div class="input-group">
                    <label for="alta-libro-genero">Género:</label>
                    <input type="text" id="alta-libro-genero" placeholder="Género del libro">
                </div>
            </div>
            <div class="form-actions">
                <button id="register-libro-button" class="button-primary">Registrar</button>
                <button id="back-to-altas-menu-from-libro" class="button-secondary">Menú Altas</button>
            </div>
        </div>

        <!-- Alta Visita Page (Page 8) -->
        <div id="alta-visita-page" class="page">
            <h1 class="form-page-header">Alta Visita</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="alta-visita-id">ID Visita:</label>
                    <input type="text" id="alta-visita-id" placeholder="ID de la visita (PK)">
                </div>
                <div class="input-group">
                    <label for="alta-visita-fecha">Fecha:</label>
                    <input type="date" id="alta-visita-fecha" placeholder="Fecha de la visita">
                </div>
                <div class="input-group">
                    <label for="alta-visita-hora">Hora:</label>
                    <input type="time" id="alta-visita-hora" placeholder="Hora de la visita">
                </div>
                <div class="input-group">
                    <label for="alta-visita-res">Resultado Visita:</label>
                    <input type="text" id="alta-visita-res" placeholder="Resultado de la visita">
                </div>
                <div class="input-group">
                    <label for="alta-visita-vendedor-fk">ID Vendedor (FK):</label>
                    <input type="text" id="alta-visita-vendedor-fk" placeholder="ID del vendedor asociado">
                </div>
                <div class="input-group">
                    <label for="alta-visita-empleado-fk">No. Empleado (FK):</label>
                    <input type="text" id="alta-visita-empleado-fk" placeholder="Número de empleado asociado">
                </div>
            </div>
            <div class="form-actions">
                <button id="register-visita-button" class="button-primary">Registrar</button>
                <button id="back-to-altas-menu-from-visita" class="button-secondary">Menú Altas</button>
            </div>
        </div>

        <!-- Modificar Menu (Page 9) -->
        <div id="modificar-menu" class="page">
            <h1 class="text-center text-3xl font-bold mb-8 text-gray-800">Menú Modificar</h1>
            <div class="menu-grid">
                <button id="btn-modificar-empleado" class="menu-button">Empleado</button>
                <button id="btn-modificar-vendedor" class="menu-button">Vendedor</button>
                <button id="btn-modificar-cliente" class="menu-button">Cliente</button>
                <button id="btn-modificar-libro" class="menu-button">Libro</button>
                <button id="btn-modificar-visita" class="menu-button">Visita</button>
            </div>
            <div class="form-actions justify-center mt-8">
                <button id="back-to-main-menu-from-modificar" class="button-secondary">Menú Principal</button>
            </div>
        </div>

        <!-- Modificar Empleado Page (Page 11) -->
        <div id="modificar-empleado-page" class="page">
            <h1 class="form-page-header">Modificar Empleado</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="modificar-empleado-no-search">Número Empleado:</label>
                    <input type="text" id="modificar-empleado-no-search" placeholder="Buscar por Número de empleado">
                </div>
                <div class="form-actions justify-center">
                    <button id="search-modificar-empleado" class="button-secondary">Buscar</button>
                </div>
                <hr class="my-6 border-t border-gray-300">

                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-nom">Nombre Empleado:</label>
                        <input type="text" id="modificar-empleado-nom" placeholder="Nombre completo del empleado" disabled>
                    </div>
                    <button id="update-empleado-nom-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-legajo">Legajo:</label>
                        <input type="text" id="modificar-empleado-legajo" placeholder="Legajo del empleado" disabled>
                    </div>
                    <button id="update-empleado-legajo-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-dir">Dirección Empleado:</label>
                        <input type="text" id="modificar-empleado-dir" placeholder="Dirección del empleado" disabled>
                    </div>
                    <button id="update-empleado-dir-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-tel">Teléfono Empleado:</label>
                        <input type="text" id="modificar-empleado-tel" placeholder="Teléfono del empleado" disabled>
                    </div>
                    <button id="update-empleado-tel-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-empresa">Empresa Empleado:</label>
                        <input type="text" id="modificar-empleado-empresa" placeholder="Empresa a la que pertenece" disabled>
                    </div>
                    <button id="update-empleado-empresa-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-correo">Correo Empleado:</label>
                        <input type="text" id="modificar-empleado-correo" placeholder="Correo electrónico del empleado" disabled>
                    </div>
                    <button id="update-empleado-correo-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-empleado-edad">Edad:</label>
                        <input type="text" id="modificar-empleado-edad" placeholder="Edad del empleado" disabled>
                    </div>
                    <button id="update-empleado-edad-button" class="button-secondary" disabled>Actualizar</button>
                </div>
            </div>
            <div class="form-actions">
                <button id="back-to-modificar-menu-from-empleado" class="button-secondary">Menú Modificar</button>
            </div>
        </div>

        <!-- Modificar Vendedor Page (Page 12) -->
        <div id="modificar-vendedor-page" class="page">
            <h1 class="form-page-header">Modificar Vendedor</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="modificar-vendedor-id-search">ID Vendedor:</label>
                    <input type="text" id="modificar-vendedor-id-search" placeholder="Buscar por ID del vendedor">
                </div>
                <div class="form-actions justify-center">
                    <button id="search-modificar-vendedor" class="button-secondary">Buscar</button>
                </div>
                <hr class="my-6 border-t border-gray-300">
                <div class="input-with-button">
                    <div>
                        <label for="modificar-vendedor-nombre">Nombre Vendedor:</label>
                        <input type="text" id="modificar-vendedor-nombre" placeholder="Nuevo nombre del vendedor" disabled>
                    </div>
                    <button id="update-vendedor-nombre-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-vendedor-tel">Teléfono Vendedor:</label>
                        <input type="text" id="modificar-vendedor-tel" placeholder="Nuevo teléfono del vendedor" disabled>
                    </div>
                    <button id="update-vendedor-tel-button" class="button-secondary" disabled>Actualizar</button>
                </div>
            </div>
            <div class="form-actions">
                <button id="back-to-modificar-menu-from-vendedor" class="button-secondary">Menú Modificar</button>
            </div>
        </div>

        <!-- Modificar Cliente Page (not in PDF but necessary) -->
        <div id="modificar-cliente-page" class="page">
            <h1 class="form-page-header">Modificar Cliente</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="modificar-cliente-id-search">ID Cliente:</label>
                    <input type="text" id="modificar-cliente-id-search" placeholder="Buscar por ID del cliente">
                </div>
                <div class="form-actions justify-center">
                    <button id="search-modificar-cliente" class="button-secondary">Buscar</button>
                </div>
                <hr class="my-6 border-t border-gray-300">
                <div class="input-with-button">
                    <div>
                        <label for="modificar-cliente-nombre">Nombre Cliente:</label>
                        <input type="text" id="modificar-cliente-nombre" placeholder="Nuevo nombre del cliente" disabled>
                    </div>
                    <button id="update-cliente-nombre-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-cliente-direccion">Dirección:</label>
                        <input type="text" id="modificar-cliente-direccion" placeholder="Nueva dirección del cliente" disabled>
                    </div>
                    <button id="update-cliente-direccion-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-cliente-telefono">Teléfono:</label>
                        <input type="text" id="modificar-cliente-telefono" placeholder="Nuevo teléfono del cliente" disabled>
                    </div>
                    <button id="update-cliente-telefono-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-cliente-correo">Correo:</label>
                        <input type="text" id="modificar-cliente-correo" placeholder="Nuevo correo electrónico del cliente" disabled>
                    </div>
                    <button id="update-cliente-correo-button" class="button-secondary" disabled>Actualizar</button>
                </div>
            </div>
            <div class="form-actions">
                <button id="back-to-modificar-menu-from-cliente" class="button-secondary">Menú Modificar</button>
            </div>
        </div>

        <!-- Modificar Libro Page (Page 13 - Completed) -->
        <div id="modificar-libro-page" class="page">
            <h1 class="form-page-header">Modificar Libro</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="modificar-libro-id-search">ID Libro:</label>
                    <input type="text" id="modificar-libro-id-search" placeholder="Buscar por ID del libro">
                </div>
                <div class="form-actions justify-center">
                    <button id="search-modificar-libro" class="button-secondary">Buscar</button>
                </div>
                <hr class="my-6 border-t border-gray-300">
                <div class="input-with-button">
                    <div>
                        <label for="modificar-libro-titulo">Título:</label>
                        <input type="text" id="modificar-libro-titulo" placeholder="Nuevo título del libro" disabled>
                    </div>
                    <button id="update-libro-titulo-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-libro-autor">Autor:</label>
                        <input type="text" id="modificar-libro-autor" placeholder="Nuevo autor del libro" disabled>
                    </div>
                    <button id="update-libro-autor-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-libro-editorial">Editorial:</label>
                        <input type="text" id="modificar-libro-editorial" placeholder="Nueva editorial del libro" disabled>
                    </div>
                    <button id="update-libro-editorial-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-libro-genero">Género:</label>
                        <input type="text" id="modificar-libro-genero" placeholder="Nuevo género del libro" disabled>
                    </div>
                    <button id="update-libro-genero-button" class="button-secondary" disabled>Actualizar</button>
                </div>
            </div>
            <div class="form-actions">
                <button id="back-to-modificar-menu-from-libro" class="button-secondary">Menú Modificar</button>
            </div>
        </div>

        <!-- Modificar Visita Page (New) -->
        <div id="modificar-visita-page" class="page">
            <h1 class="form-page-header">Modificar Visita</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="modificar-visita-id-search">ID Visita:</label>
                    <input type="text" id="modificar-visita-id-search" placeholder="Buscar por ID de la visita">
                </div>
                <div class="form-actions justify-center">
                    <button id="search-modificar-visita" class="button-secondary">Buscar</button>
                </div>
                <hr class="my-6 border-t border-gray-300">
                <div class="input-with-button">
                    <div>
                        <label for="modificar-visita-fecha">Fecha:</label>
                        <input type="date" id="modificar-visita-fecha" placeholder="Nueva fecha de la visita" disabled>
                    </div>
                    <button id="update-visita-fecha-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-visita-hora">Hora:</label>
                        <input type="time" id="modificar-visita-hora" placeholder="Nueva hora de la visita" disabled>
                    </div>
                    <button id="update-visita-hora-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-visita-res">Resultado Visita:</label>
                        <input type="text" id="modificar-visita-res" placeholder="Nuevo resultado de la visita" disabled>
                    </div>
                    <button id="update-visita-res-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-visita-vendedor-fk">ID Vendedor (FK):</label>
                        <input type="text" id="modificar-visita-vendedor-fk" placeholder="Nuevo ID de vendedor" disabled>
                    </div>
                    <button id="update-visita-vendedor-fk-button" class="button-secondary" disabled>Actualizar</button>
                </div>
                <div class="input-with-button">
                    <div>
                        <label for="modificar-visita-empleado-fk">No. Empleado (FK):</label>
                        <input type="text" id="modificar-visita-empleado-fk" placeholder="Nuevo No. de empleado" disabled>
                    </div>
                    <button id="update-visita-empleado-fk-button" class="button-secondary" disabled>Actualizar</button>
                </div>
            </div>
            <div class="form-actions">
                <button id="back-to-modificar-menu-from-visita" class="button-secondary">Menú Modificar</button>
            </div>
        </div>

        <!-- Consulta Menu (New) -->
        <div id="consulta-menu" class="page">
            <h1 class="text-center text-3xl font-bold mb-8 text-gray-800">Menú Consulta</h1>
            <div class="menu-grid">
                <button id="btn-consulta-empleado" class="menu-button">Empleado</button>
                <button id="btn-consulta-vendedor" class="menu-button">Vendedor</button>
                <button id="btn-consulta-cliente" class="menu-button">Cliente</button>
                <button id="btn-consulta-libro" class="menu-button">Libro</button>
                <button id="btn-consulta-visita" class="menu-button">Visita</button>
                <button id="btn-consulta-venta" class="menu-button">Venta</button>
            </div>
            <div class="form-actions justify-center mt-8">
                <button id="back-to-main-menu-from-consulta" class="button-secondary">Menú Principal</button>
            </div>
        </div>

        <!-- Consulta Empleado Page (New) -->
        <div id="consulta-empleado-page" class="page">
            <h1 class="form-page-header">Consultar Empleado</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="consulta-empleado-no-search">Número Empleado (opcional para todos):</label>
                    <input type="text" id="consulta-empleado-no-search" placeholder="Buscar por número de empleado">
                </div>
            </div>
            <div class="form-actions justify-center">
                <button id="search-consulta-empleado" class="button-secondary">Buscar</button>
                <button id="back-to-consulta-menu-from-empleado" class="button-secondary">Menú Consulta</button>
            </div>
            <div id="consulta-empleado-results" class="w-full mt-8">
                <!-- Results table will be inserted here -->
            </div>
        </div>

        <!-- Consulta Vendedor Page (New) -->
        <div id="consulta-vendedor-page" class="page">
            <h1 class="form-page-header">Consultar Vendedor</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="consulta-vendedor-id-search">ID Vendedor (opcional para todos):</label>
                    <input type="text" id="consulta-vendedor-id-search" placeholder="Buscar por ID de vendedor">
                </div>
            </div>
            <div class="form-actions justify-center">
                <button id="search-consulta-vendedor" class="button-secondary">Buscar</button>
                <button id="back-to-consulta-menu-from-vendedor" class="button-secondary">Menú Consulta</button>
            </div>
            <div id="consulta-vendedor-results" class="w-full mt-8">
                <!-- Results table will be inserted here -->
            </div>
        </div>

        <!-- Consulta Cliente Page (New) -->
        <div id="consulta-cliente-page" class="page">
            <h1 class="form-page-header">Consultar Cliente</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="consulta-cliente-id-search">ID Cliente (opcional para todos):</label>
                    <input type="text" id="consulta-cliente-id-search" placeholder="Buscar por ID de cliente">
                </div>
            </div>
            <div class="form-actions justify-center">
                <button id="search-consulta-cliente" class="button-secondary">Buscar</button>
                <button id="back-to-consulta-menu-from-cliente" class="button-secondary">Menú Consulta</button>
            </div>
            <div id="consulta-cliente-results" class="w-full mt-8">
                <!-- Results table will be inserted here -->
            </div>
        </div>

        <!-- Consulta Libro Page (New) -->
        <div id="consulta-libro-page" class="page">
            <h1 class="form-page-header">Consultar Libro</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="consulta-libro-id-search">ID Libro (opcional para todos):</label>
                    <input type="text" id="consulta-libro-id-search" placeholder="Buscar por ID de libro">
                </div>
            </div>
            <div class="form-actions justify-center">
                <button id="search-consulta-libro" class="button-secondary">Buscar</button>
                <button id="back-to-consulta-menu-from-libro" class="button-secondary">Menú Consulta</button>
            </div>
            <div id="consulta-libro-results" class="w-full mt-8">
                <!-- Results table will be inserted here -->
            </div>
        </div>

        <!-- Consulta Visita Page (New) -->
        <div id="consulta-visita-page" class="page">
            <h1 class="form-page-header">Consultar Visita</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="consulta-visita-id-search">ID Visita (opcional para todos):</label>
                    <input type="text" id="consulta-visita-id-search" placeholder="Buscar por ID de visita">
                </div>
            </div>
            <div class="form-actions justify-center">
                <button id="search-consulta-visita" class="button-secondary">Buscar</button>
                <button id="back-to-consulta-menu-from-visita" class="button-secondary">Menú Consulta</button>
            </div>
            <div id="consulta-visita-results" class="w-full mt-8">
                <!-- Results table will be inserted here -->
            </div>
        </div>

        <!-- Consulta Venta Page (New) -->
        <div id="consulta-venta-page" class="page">
            <h1 class="form-page-header">Consultar Venta</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="consulta-venta-id-search">ID Venta (opcional para todos):</label>
                    <input type="text" id="consulta-venta-id-search" placeholder="Buscar por ID de venta">
                </div>
            </div>
            <div class="form-actions justify-center">
                <button id="search-consulta-venta" class="button-secondary">Buscar</button>
                <button id="back-to-consulta-menu-from-venta" class="button-secondary">Menú Consulta</button>
            </div>
            <div id="consulta-venta-results" class="w-full mt-8">
                <!-- Results table will be inserted here -->
            </div>
        </div>

        <!-- Baja Menu (New) -->
        <div id="baja-menu" class="page">
            <h1 class="text-center text-3xl font-bold mb-8 text-gray-800">Menú Baja</h1>
            <div class="menu-grid">
                <button id="btn-baja-empleado" class="menu-button">Empleado</button>
                <button id="btn-baja-vendedor" class="menu-button">Vendedor</button>
                <button id="btn-baja-cliente" class="menu-button">Cliente</button>
                <button id="btn-baja-libro" class="menu-button">Libro</button>
                <button id="btn-baja-visita" class="menu-button">Visita</button>
            </div>
            <div class="form-actions justify-center mt-8">
                <button id="back-to-main-menu-from-baja" class="button-secondary">Menú Principal</button>
            </div>
        </div>

        <!-- Baja Empleado Page (New) -->
        <div id="baja-empleado-page" class="page">
            <h1 class="form-page-header">Baja Empleado</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="baja-empleado-no">Número de Empleado a Eliminar:</label>
                    <input type="text" id="baja-empleado-no" placeholder="Número de empleado">
                </div>
            </div>
            <div class="form-actions">
                <button id="delete-empleado-button" class="button-danger">Eliminar</button>
                <button id="back-to-baja-menu-from-empleado" class="button-secondary">Menú Baja</button>
            </div>
        </div>

        <!-- Baja Vendedor Page (New) -->
        <div id="baja-vendedor-page" class="page">
            <h1 class="form-page-header">Baja Vendedor</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="baja-vendedor-id">ID de Vendedor a Eliminar:</label>
                    <input type="text" id="baja-vendedor-id" placeholder="ID del vendedor">
                </div>
            </div>
            <div class="form-actions">
                <button id="delete-vendedor-button" class="button-danger">Eliminar</button>
                <button id="back-to-baja-menu-from-vendedor" class="button-secondary">Menú Baja</button>
            </div>
        </div>

        <!-- Baja Cliente Page (New) -->
        <div id="baja-cliente-page" class="page">
            <h1 class="form-page-header">Baja Cliente</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="baja-cliente-id">ID de Cliente a Eliminar:</label>
                    <input type="text" id="baja-cliente-id" placeholder="ID del cliente">
                </div>
            </div>
            <div class="form-actions">
                <button id="delete-cliente-button" class="button-danger">Eliminar</button>
                <button id="back-to-baja-menu-from-cliente" class="button-secondary">Menú Baja</button>
            </div>
        </div>

        <!-- Baja Libro Page (New) -->
        <div id="baja-libro-page" class="page">
            <h1 class="form-page-header">Baja Libro</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="baja-libro-id">ID de Libro a Eliminar:</label>
                    <input type="text" id="baja-libro-id" placeholder="ID del libro">
                </div>
            </div>
            <div class="form-actions">
                <button id="delete-libro-button" class="button-danger">Eliminar</button>
                <button id="back-to-baja-menu-from-libro" class="button-secondary">Menú Baja</button>
            </div>
        </div>

        <!-- Baja Visita Page (New) -->
        <div id="baja-visita-page" class="page">
            <h1 class="form-page-header">Baja Visita</h1>
            <div class="form-content">
                <div class="input-group">
                    <label for="baja-visita-id">ID de Visita a Eliminar:</label>
                    <input type="text" id="baja-visita-id" placeholder="ID de la visita">
                </div>
            </div>
            <div class="form-actions">
                <button id="delete-visita-button" class="button-danger">Eliminar</button>
                <button id="back-to-baja-menu-from-visita" class="button-secondary">Menú Baja</button>
            </div>
        </div>

        <!-- Custom Confirmation Dialog -->
        <div id="confirmation-dialog-overlay" class="dialog-overlay">
            <div class="dialog-content">
                <p id="confirmation-message"></p>
                <div class="dialog-actions">
                    <button id="confirm-yes" class="button-primary">Sí</button>
                    <button id="confirm-no" class="button-danger">No</button>
                </div>
            </div>
        </div>

        <!-- Custom Message Dialog -->
        <div id="message-dialog-overlay" class="dialog-overlay">
            <div class="dialog-content">
                <p id="message-text"></p>
                <div class="dialog-actions">
                    <button id="message-ok" class="button-primary">OK</button>
                </div>
            </div>
        </div>

    </div>

    <script type="module">
        // --- Local Data Storage (in-memory with localStorage persistence) ---
        let localEmpleados = [];
        let localVendedores = [];
        let localClientes = [];
        let localLibros = [];
        let localVisitas = [];
        let localVentas = [];
        // localVentaLibros array and its data are completely removed as per user request.

        /**
         * Saves all local data arrays to localStorage.
         */
        function saveAllData() {
            localStorage.setItem('localEmpleados', JSON.stringify(localEmpleados));
            localStorage.setItem('localVendedores', JSON.stringify(localVendedores));
            localStorage.setItem('localClientes', JSON.stringify(localClientes));
            localStorage.setItem('localLibros', JSON.stringify(localLibros));
            localStorage.setItem('localVisitas', JSON.stringify(localVisitas));
            localStorage.setItem('localVentas', JSON.stringify(localVentas));
        }

        /**
         * Loads all local data arrays from localStorage or initializes with dummy data.
         */
        function loadInitialData() {
            const storedEmpleados = localStorage.getItem('localEmpleados');
            const storedVendedores = localStorage.getItem('localVendedores');
            const storedClientes = localStorage.getItem('localClientes');
            const storedLibros = localStorage.getItem('localLibros');
            const storedVisitas = localStorage.getItem('localVisitas');
            const storedVentas = localStorage.getItem('localVentas');

            if (storedEmpleados && storedVendedores && storedClientes && storedLibros && storedVisitas && storedVentas) {
                localEmpleados = JSON.parse(storedEmpleados);
                localVendedores = JSON.parse(storedVendedores);
                localClientes = JSON.parse(storedClientes);
                localLibros = JSON.parse(storedLibros);
                localVisitas = JSON.parse(storedVisitas);
                localVentas = JSON.parse(storedVentas);
            } else {
                // Dummy data if nothing in localStorage
                localEmpleados = [
                    { id: '1', NO_EMPLEADO_PK: 1, NOM_EMPLEADO: 'Juan Perez', LEGAJO: 'EMP001', DIR_EMPLEADO: 'Calle Falsa 123', TEL_EMPLEADO: '555-1234', EMPRESA_EMPLEADO: 'Tech Solutions', CORREO_EMPLEADO: 'juan.p@tech.com', EDAD: 30 },
                    { id: '2', NO_EMPLEADO_PK: 2, NOM_EMPLEADO: 'Maria Garcia', LEGAJO: 'EMP002', DIR_EMPLEADO: 'Av. Siempre Viva 45', TEL_EMPLEADO: '555-5678', EMPRESA_EMPLEADO: 'Global Innovations', CORREO_EMPLEADO: 'maria.g@global.com', EDAD: 25 }
                ];
                localVendedores = [
                    { id: '1', ID_VENDEDOR_PK: 1, NOMBRE_VENDEDOR: 'Akira Yamato', TEL_VENDEDOR: '5511223344' },
                    { id: '2', ID_VENDEDOR_PK: 2, NOMBRE_VENDEDOR: 'Liam Müller', TEL_VENDEDOR: '4988123456' }
                ];
                localClientes = [
                    { id: '1', ID_CLIENTE_PK: 1, NOMBRE_CLIENTE: 'Roberto Sanchez', DIR_CLIENTE: 'Calle Roble 10', TEL_CLIENTE: '555-9876', CORREO_CLIENTE: 'roberto@email.com' },
                    { id: '2', ID_CLIENTE_PK: 2, NOMBRE_CLIENTE: 'Ana Lopez', DIR_CLIENTE: 'Av. Pino 20', TEL_CLIENTE: '555-4321', CORREO_CLIENTE: 'ana@email.com' }
                ];
                localLibros = [
                    { id: '1', ID_LIBRO_PK: 1, TITULO_LIB: 'Shantaram', AUTOR: 'G. D. Roberts', EDITORIAL_LIBRO: 'Abacus', GENERO_LIBRO: 'Ficción' },
                    { id: '2', ID_LIBRO_PK: 2, TITULO_LIB: 'Pachinko', AUTOR: 'Min Jin Lee', EDITORIAL_LIBRO: 'Grand Central', GENERO_LIBRO: 'Drama' }
                ];
                localVisitas = [
                    { id: '1', ID_VISITA_PK: 1, FECHA_VISITA: '2025-06-01', HORA_VISITA: '09:00', RES_VISITA: 'Interesado', ID_VENDEDOR_FK: 1, NO_EMPLEADO_FK: 1 },
                    { id: '2', ID_VISITA_PK: 2, FECHA_VISITA: '2025-06-01', HORA_VISITA: '10:30', RES_VISITA: 'Compra segura', ID_VENDEDOR_FK: 2, NO_EMPLEADO_FK: 2 }
                ];
                localVentas = [
                    { id: '1', ID_VENTA_PK: 1, FECHA_VENTA: '2025-06-01', HORA_VENTA: '09:15', LIBROS_VENTA: 3, ID_VISITA_FK: 1 },
                    { id: '2', ID_VENTA_PK: 2, FECHA_VENTA: '2025-06-01', HORA_VENTA: '10:45', LIBROS_VENTA: 5, ID_VISITA_FK: 2 }
                ];
                saveAllData(); // Save dummy data to localStorage
            }
        }

        // --- Utility Functions ---

        /**
         * Shows a specific page and hides all others.
         * @param {string} pageId The ID of the page to show.
         */
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
        }

        /**
         * Clears all input fields and manages button states within a given page element.
         * @param {string} pageId The ID of the page whose inputs should be cleared.
         */
        function clearInputs(pageId) {
            const page = document.getElementById(pageId);
            if (page) {
                page.querySelectorAll('input[type="text"], input[type="password"], input[type="date"], input[type="time"], textarea').forEach(input => {
                    input.value = '';
                    input.disabled = false; // Re-enable inputs after clearing for new entry
                });
                // Disable all buttons with 'button-primary' or 'button-secondary' or 'button-danger' within the page,
                // except for specific ones like search, back, login, exit, logout, register, and DELETE buttons.
                page.querySelectorAll('.button-primary, .button-secondary, .button-danger').forEach(button => {
                    if (!button.id.includes('back-to-') && !button.id.includes('search-') && !button.id.includes('login-') && !button.id.includes('exit-') && !button.id.includes('main-menu-logout') && !button.id.includes('register-') && !button.id.includes('delete-')) {
                        button.disabled = true;
                    } else {
                        // Re-enable buttons that are in the exclusion list (register, search, delete, back, etc.)
                        button.disabled = false;
                    }
                });
            }
        }


        /**
         * Shows a custom message dialog.
         * @param {string} message The message to display.
         */
        function showMessage(message) {
            document.getElementById('message-text').textContent = message;
            document.getElementById('message-dialog-overlay').classList.add('active');
        }

        /**
         * Shows a custom confirmation dialog.
         * @param {string} message The confirmation message.
         * @returns {Promise<boolean>} A promise that resolves to true if confirmed, false otherwise.
         */
        function showConfirm(message) {
            return new Promise(resolve => {
                document.getElementById('confirmation-message').textContent = message;
                document.getElementById('confirmation-dialog-overlay').classList.add('active');

                const confirmYes = document.getElementById('confirm-yes');
                const confirmNo = document.getElementById('confirm-no');

                const handleYes = () => {
                    document.getElementById('confirmation-dialog-overlay').classList.remove('active');
                    confirmYes.removeEventListener('click', handleYes);
                    confirmNo.removeEventListener('click', handleNo);
                    resolve(true);
                };

                const handleNo = () => {
                    document.getElementById('confirmation-dialog-overlay').classList.remove('active');
                    confirmYes.removeEventListener('click', handleYes);
                    confirmNo.removeEventListener('click', handleNo);
                    resolve(false);
                };

                confirmYes.addEventListener('click', handleYes);
                confirmNo.addEventListener('click', handleNo);
            });
        }

        /**
         * Renders data into a table.
         * @param {HTMLElement} containerElement The DOM element to append the table to.
         * @param {Array<Object>} data The array of objects to display.
         * @param {Array<string>} headers The array of header keys to display.
         */
        function renderTable(containerElement, data, headers) {
            containerElement.innerHTML = ''; // Clear previous results

            if (!data || data.length === 0) {
                containerElement.innerHTML = '<p class="text-center text-gray-600">No se encontraron resultados.</p>';
                return;
            }

            const table = document.createElement('table');
            table.classList.add('results-table');

            // Create table header
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            headers.forEach(headerText => {
                const th = document('th');
                th.textContent = headerText.replace(/_/g, ' ').toUpperCase(); // Format header text
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            // Create table body
            const tbody = document.createElement('tbody');
            data.forEach(item => {
                const tr = document.createElement('tr');
                headers.forEach(headerKey => {
                    const td = document.createElement('td');
                    td.textContent = item[headerKey] !== undefined ? item[headerKey] : '';
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });
            table.appendChild(tbody);

            containerElement.appendChild(table);
        }

        // --- Local Data Operations (replacing Firestore) ---

        /**
         * Gets the local data array based on collection name.
         * @param {string} collectionName
         * @returns {Array} The corresponding local array.
         */
        function getLocalCollection(collectionName) {
            switch (collectionName) {
                case 'empleados': return localEmpleados;
                case 'vendedores': return localVendedores;
                case 'clientes': return localClientes;
                case 'libros': return localLibros;
                case 'visitas': return localVisitas;
                case 'ventas': return localVentas;
                default: return [];
            }
        }

        /**
         * Adds a new document to a specified local collection.
         * @param {string} collectionName The name of the collection.
         * @param {Object} data The data to add.
         * @param {string} docId The ID of the document (for setDoc), or null for addDoc.
         * @returns {Promise<boolean>} True if successful, false otherwise.
         */
        async function addDocument(collectionName, data, docId = null) {
            const collection = getLocalCollection(collectionName);
            let existingIndex = -1;

            if (docId) {
                // For collections where PK is used as docId (e.g., Empleado, Vendedor, Libro, Cliente, Visita, Venta)
                // We assume docId is the primary key value.
                let pkField;
                switch (collectionName) {
                    case 'empleados': pkField = 'NO_EMPLEADO_PK'; break;
                    case 'vendedores': pkField = 'ID_VENDEDOR_PK'; break;
                    case 'clientes': pkField = 'ID_CLIENTE_PK'; break;
                    case 'libros': pkField = 'ID_LIBRO_PK'; break;
                    case 'visitas': pkField = 'ID_VISITA_PK'; break;
                    case 'ventas': pkField = 'ID_VENTA_PK'; break;
                    default: pkField = 'id'; // Fallback for cases like auto-generated IDs
                }

                existingIndex = collection.findIndex(item => String(item[pkField]) === String(docId));
            }

            if (existingIndex !== -1) {
                showMessage(`Error: Un registro con el ID/PK ${docId} ya existe en ${collectionName}.`);
                return false;
            }

            const newId = docId || String(Date.now()); // Simple unique ID generation
            collection.push({ id: newId, ...data });
            saveAllData();
            console.log(`Documento con ID ${newId} añadido a ${collectionName}.`);
            return true;
        }


        /**
         * Fetches a single document from a local collection by its ID (which is the PK value).
         * @param {string} collectionName The name of the collection.
         * @param {string} docId The ID/PK of the document to fetch.
         * @returns {Promise<Object|null>} The document data, or null if not found.
         */
        async function getDocumentById(collectionName, docId) {
            const collection = getLocalCollection(collectionName);
            let pkField;
            switch (collectionName) {
                case 'empleados': pkField = 'NO_EMPLEADO_PK'; break;
                case 'vendedores': pkField = 'ID_VENDEDOR_PK'; break;
                case 'clientes': pkField = 'ID_CLIENTE_PK'; break;
                case 'libros': pkField = 'ID_LIBRO_PK'; break;
                case 'visitas': pkField = 'ID_VISITA_PK'; break;
                case 'ventas': pkField = 'ID_VENTA_PK'; break;
                default: pkField = 'id'; // Fallback for auto-generated IDs or other cases
            }

            const found = collection.find(item => String(item[pkField]) === String(docId));
            return found ? { id: found.id, ...found } : null;
        }

        /**
         * Updates an existing document in a local collection.
         * @param {string} collectionName The name of the collection.
         * @param {string} docId The ID/PK of the document to update.
         * @param {Object} data The data to update.
         * @returns {Promise<boolean>} True if successful, false otherwise.
         */
        async function updateDocument(collectionName, docId, data) {
            const collection = getLocalCollection(collectionName);
            let pkField;
            switch (collectionName) {
                case 'empleados': pkField = 'NO_EMPLEADO_PK'; break;
                case 'vendedores': pkField = 'ID_VENDEDOR_PK'; break;
                case 'clientes': pkField = 'ID_CLIENTE_PK'; break;
                case 'libros': pkField = 'ID_LIBRO_PK'; break;
                case 'visitas': pkField = 'ID_VISITA_PK'; break;
                case 'ventas': pkField = 'ID_VENTA_PK'; break;
                default: pkField = 'id';
            }

            const index = collection.findIndex(item => String(item[pkField]) === String(docId));

            if (index !== -1) {
                // Update the existing item with new data
                const updatedItem = { ...collection[index], ...data };
                collection[index] = updatedItem;
                saveAllData();
                console.log(`Documento con ID ${docId} actualizado en ${collectionName}.`);
                return true;
            } else {
                showMessage("Documento no encontrado para actualizar.");
                return false;
            }
        }

        /**
         * Deletes a document from a local collection by its ID (which is the PK value).
         * @param {string} collectionName The name of the collection.
         * @param {string} docId The ID/PK of the document to delete.
         * @returns {Promise<boolean>} True if successful, false otherwise.
         */
        async function deleteDocument(collectionName, docId) {
            let collection = getLocalCollection(collectionName);
            let pkField;
            switch (collectionName) {
                case 'empleados': pkField = 'NO_EMPLEADO_PK'; break;
                case 'vendedores': pkField = 'ID_VENDEDOR_PK'; break;
                case 'clientes': pkField = 'ID_CLIENTE_PK'; break;
                case 'libros': pkField = 'ID_LIBRO_PK'; break;
                case 'visitas': pkField = 'ID_VISITA_PK'; break;
                case 'ventas': pkField = 'ID_VENTA_PK'; break;
                default: pkField = 'id';
            }

            const indexToDelete = collection.findIndex(item => String(item[pkField]) === String(docId));

            if (indexToDelete !== -1) {
                // Remove the item from the array
                collection.splice(indexToDelete, 1);

                // Update the global array reference (important since 'collection' was a local copy)
                switch (collectionName) {
                    case 'empleados': localEmpleados = collection; break;
                    case 'vendedores': localVendedores = collection; break;
                    case 'clientes': localClientes = collection; break;
                    case 'libros': localLibros = collection; break;
                    case 'visitas': localVisitas = collection; break;
                    case 'ventas': localVentas = collection; break;
                }

                saveAllData();
                console.log(`Documento con ID ${docId} eliminado de ${collectionName}.`);
                return true;
            } else {
                showMessage("Documento no encontrado para eliminar.");
                return false;
            }
        }

        /**
         * Fetches documents from a local collection, optionally filtered by a field.
         * @param {string} collectionName The name of the collection.
         * @param {string} [fieldToFilter=null] The field to filter by.
         * @param {string|number} [valueToFilter=null] The value to filter by.
         * @returns {Promise<Array<Object>>} An array of document data.
         */
        async function getDocuments(collectionName, fieldToFilter = null, valueToFilter = null) {
            const collection = getLocalCollection(collectionName);
            if (fieldToFilter && valueToFilter !== null && valueToFilter !== undefined && valueToFilter !== '') {
                return collection.filter(item => {
                    // Handle numeric vs string comparison
                    if (typeof item[fieldToFilter] === 'number') {
                        return item[fieldToFilter] === parseInt(valueToFilter);
                    }
                    return String(item[fieldToFilter]).toLowerCase().includes(String(valueToFilter).toLowerCase());
                });
            } else {
                return collection;
            }
        }

        // --- Event Listeners and Page Logic ---

        document.addEventListener('DOMContentLoaded', () => {
            loadInitialData(); // Load data when the DOM is ready

            // Dialog OK button
            document.getElementById('message-ok').addEventListener('click', () => {
                document.getElementById('message-dialog-overlay').classList.remove('active');
            });

            // Login Page
            document.getElementById('login-button').addEventListener('click', () => {
                // Simple hardcoded login for demonstration without Firebase Auth
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                if (username === 'admin' && password === 'admin') { // Example credentials
                    showMessage("Inicio de sesión exitoso.");
                    showPage('main-menu');
                } else {
                    showMessage("Usuario o contraseña incorrectos.");
                }
            });

            document.getElementById('exit-button').addEventListener('click', () => {
                showMessage("Saliendo de la aplicación.");
                // In a real browser environment, you might close the window or redirect.
                // window.close(); // Might not work in all browsers due to security
            });

            // Main Menu
            document.getElementById('btn-alta').addEventListener('click', () => showPage('altas-menu'));
            document.getElementById('btn-modificar').addEventListener('click', () => showPage('modificar-menu'));
            document.getElementById('btn-consulta').addEventListener('click', () => showPage('consulta-menu'));
            document.getElementById('btn-baja').addEventListener('click', () => showPage('baja-menu'));
            document.getElementById('main-menu-logout').addEventListener('click', () => {
                showMessage("Sesión cerrada.");
                showPage('login-page');
                // Optionally clear username/password fields
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            });

            // Altas Menu
            document.getElementById('btn-alta-empleado').addEventListener('click', () => { clearInputs('alta-empleado-page'); showPage('alta-empleado-page'); });
            document.getElementById('btn-alta-vendedor').addEventListener('click', () => { clearInputs('alta-vendedor-page'); showPage('alta-vendedor-page'); });
            document.getElementById('btn-alta-cliente').addEventListener('click', () => { clearInputs('alta-cliente-page'); showPage('alta-cliente-page'); });
            document.getElementById('btn-alta-libro').addEventListener('click', () => { clearInputs('alta-libro-page'); showPage('alta-libro-page'); });
            document.getElementById('btn-alta-visita').addEventListener('click', () => { clearInputs('alta-visita-page'); showPage('alta-visita-page'); });
            document.getElementById('back-to-main-menu-from-altas').addEventListener('click', () => showPage('main-menu'));

            // Alta Empleado
            document.getElementById('register-empleado-button').addEventListener('click', async () => {
                const noEmpleado = document.getElementById('alta-empleado-no').value.trim();
                const nomEmpleado = document.getElementById('alta-empleado-nom').value.trim();
                const legajo = document.getElementById('alta-empleado-legajo').value.trim();
                const dirEmpleado = document.getElementById('alta-empleado-dir').value.trim();
                const telEmpleado = document.getElementById('alta-empleado-tel').value.trim();
                const empresaEmpleado = document.getElementById('alta-empleado-empresa').value.trim();
                const correoEmpleado = document.getElementById('alta-empleado-correo').value.trim();
                const edad = document.getElementById('alta-empleado-edad').value.trim();

                if (!noEmpleado || !nomEmpleado || !legajo || !dirEmpleado || !telEmpleado || !empresaEmpleado || !correoEmpleado || !edad) {
                    showMessage("Por favor, complete todos los campos para el empleado.");
                    return;
                }

                // Check for existing employee by PK
                const existingEmpleado = await getDocumentById('empleados', noEmpleado);
                if (existingEmpleado) {
                    showMessage("Error: Ya existe un empleado con ese número.");
                    return;
                }

                const success = await addDocument('empleados', {
                    NO_EMPLEADO_PK: parseInt(noEmpleado),
                    NOM_EMPLEADO: nomEmpleado,
                    LEGAJO: legajo,
                    DIR_EMPLEADO: dirEmpleado,
                    TEL_EMPLEADO: telEmpleado,
                    EMPRESA_EMPLEADO: empresaEmpleado,
                    CORREO_EMPLEADO: correoEmpleado,
                    EDAD: parseInt(edad)
                }, noEmpleado); // Use NO_EMPLEADO_PK as doc ID
                if (success) {
                    showMessage("Empleado registrado exitosamente.");
                    clearInputs('alta-empleado-page');
                }
            });
            document.getElementById('back-to-altas-menu-from-empleado').addEventListener('click', () => showPage('altas-menu'));

            // Alta Vendedor
            document.getElementById('register-vendedor-button').addEventListener('click', async () => {
                const idVendedor = document.getElementById('alta-vendedor-id').value.trim();
                const nombreVendedor = document.getElementById('alta-vendedor-nombre').value.trim();
                const telVendedor = document.getElementById('alta-vendedor-tel').value.trim();

                if (!idVendedor || !nombreVendedor || !telVendedor) {
                    showMessage("Por favor, complete todos los campos para el vendedor.");
                    return;
                }

                // Check for existing seller by PK
                const existingVendedor = await getDocumentById('vendedores', idVendedor);
                if (existingVendedor) {
                    showMessage("Error: Ya existe un vendedor con ese ID.");
                    return;
                }

                const success = await addDocument('vendedores', {
                    ID_VENDEDOR_PK: parseInt(idVendedor),
                    NOMBRE_VENDEDOR: nombreVendedor,
                    TEL_VENDEDOR: telVendedor
                }, idVendedor); // Use ID_VENDEDOR_PK as doc ID
                if (success) {
                    showMessage("Vendedor registrado exitosamente.");
                    clearInputs('alta-vendedor-page');
                }
            });
            document.getElementById('back-to-altas-menu-from-vendedor').addEventListener('click', () => showPage('altas-menu'));

            // Alta Cliente
            document.getElementById('register-cliente-button').addEventListener('click', async () => {
                const idCliente = document.getElementById('alta-cliente-id').value.trim();
                const nombreCliente = document.getElementById('alta-cliente-nombre').value.trim();
                const direccion = document.getElementById('alta-cliente-direccion').value.trim();
                const telefono = document.getElementById('alta-cliente-telefono').value.trim();
                const correo = document.getElementById('alta-cliente-correo').value.trim();

                if (!idCliente || !nombreCliente || !direccion || !telefono || !correo) {
                    showMessage("Por favor, complete todos los campos para el cliente.");
                    return;
                }

                // Check for existing client by PK
                const existingCliente = await getDocumentById('clientes', idCliente);
                if (existingCliente) {
                    showMessage("Error: Ya existe un cliente con ese ID.");
                    return;
                }

                const success = await addDocument('clientes', {
                    ID_CLIENTE_PK: parseInt(idCliente),
                    NOMBRE_CLIENTE: nombreCliente,
                    DIR_CLIENTE: direccion,
                    TEL_CLIENTE: telefono,
                    CORREO_CLIENTE: correo
                }, idCliente); // Use ID_CLIENTE_PK as doc ID
                if (success) {
                    showMessage("Cliente registrado exitosamente.");
                    clearInputs('alta-cliente-page');
                }
            });
            document.getElementById('back-to-altas-menu-from-cliente-alta').addEventListener('click', () => showPage('altas-menu'));

            // Alta Libro
            document.getElementById('register-libro-button').addEventListener('click', async () => {
                const idLibro = document.getElementById('alta-libro-id').value.trim();
                const tituloLib = document.getElementById('alta-libro-titulo').value.trim();
                const autor = document.getElementById('alta-libro-autor').value.trim();
                const editorialLibro = document.getElementById('alta-libro-editorial').value.trim();
                const generoLibro = document.getElementById('alta-libro-genero').value.trim();

                if (!idLibro || !tituloLib || !autor || !editorialLibro || !generoLibro) {
                    showMessage("Por favor, complete todos los campos para el libro.");
                    return;
                }

                // Check for existing book by PK
                const existingLibro = await getDocumentById('libros', idLibro);
                if (existingLibro) {
                    showMessage("Error: Ya existe un libro con ese ID.");
                    return;
                }

                const success = await addDocument('libros', {
                    ID_LIBRO_PK: parseInt(idLibro),
                    TITULO_LIB: tituloLib,
                    AUTOR: autor,
                    EDITORIAL_LIBRO: editorialLibro,
                    GENERO_LIBRO: generoLibro
                }, idLibro); // Use ID_LIBRO_PK as doc ID
                if (success) {
                    showMessage("Libro registrado exitosamente.");
                    clearInputs('alta-libro-page');
                }
            });
            document.getElementById('back-to-altas-menu-from-libro').addEventListener('click', () => showPage('altas-menu'));

            // Alta Visita
            document.getElementById('register-visita-button').addEventListener('click', async () => {
                const idVisita = document.getElementById('alta-visita-id').value.trim();
                const fechaVisita = document.getElementById('alta-visita-fecha').value.trim();
                const horaVisita = document.getElementById('alta-visita-hora').value.trim();
                const resVisita = document.getElementById('alta-visita-res').value.trim();
                const idVendedorFk = document.getElementById('alta-visita-vendedor-fk').value.trim();
                const noEmpleadoFk = document.getElementById('alta-visita-empleado-fk').value.trim();

                if (!idVisita || !fechaVisita || !horaVisita || !resVisita || !idVendedorFk || !noEmpleadoFk) {
                    showMessage("Por favor, complete todos los campos para la visita.");
                    return;
                }

                // Check for existing visit by PK
                const existingVisita = await getDocumentById('visitas', idVisita);
                if (existingVisita) {
                    showMessage("Error: Ya existe una visita con ese ID.");
                    return;
                }

                const success = await addDocument('visitas', {
                    ID_VISITA_PK: parseInt(idVisita),
                    FECHA_VISITA: fechaVisita,
                    HORA_VISITA: horaVisita,
                    RES_VISITA: resVisita,
                    ID_VENDEDOR_FK: parseInt(idVendedorFk),
                    NO_EMPLEADO_FK: parseInt(noEmpleadoFk)
                }, idVisita); // Use ID_VISITA_PK as doc ID
                if (success) {
                    showMessage("Visita registrada exitosamente.");
                    clearInputs('alta-visita-page');
                }
            });
            document.getElementById('back-to-altas-menu-from-visita').addEventListener('click', () => showPage('altas-menu'));


            // Modificar Menu
            document.getElementById('btn-modificar-empleado').addEventListener('click', () => { clearInputs('modificar-empleado-page'); showPage('modificar-empleado-page'); });
            document.getElementById('btn-modificar-vendedor').addEventListener('click', () => { clearInputs('modificar-vendedor-page'); showPage('modificar-vendedor-page'); });
            document.getElementById('btn-modificar-cliente').addEventListener('click', () => { clearInputs('modificar-cliente-page'); showPage('modificar-cliente-page'); });
            document.getElementById('btn-modificar-libro').addEventListener('click', () => { clearInputs('modificar-libro-page'); showPage('modificar-libro-page'); });
            document.getElementById('btn-modificar-visita').addEventListener('click', () => { clearInputs('modificar-visita-page'); showPage('modificar-visita-page'); });
            document.getElementById('back-to-main-menu-from-modificar').addEventListener('click', () => showPage('main-menu'));

            // Modificar Empleado
            let currentEmpleadoDocId = null; // This will store the NO_EMPLEADO_PK
            document.getElementById('search-modificar-empleado').addEventListener('click', async () => {
                const noEmpleadoSearch = document.getElementById('modificar-empleado-no-search').value.trim();
                const inputs = [
                    document.getElementById('modificar-empleado-nom'),
                    document.getElementById('modificar-empleado-legajo'),
                    document.getElementById('modificar-empleado-dir'),
                    document.getElementById('modificar-empleado-tel'),
                    document.getElementById('modificar-empleado-empresa'),
                    document.getElementById('modificar-empleado-correo'),
                    document.getElementById('modificar-empleado-edad')
                ];
                const buttons = [
                    document.getElementById('update-empleado-nom-button'),
                    document.getElementById('update-empleado-legajo-button'),
                    document.getElementById('update-empleado-dir-button'),
                    document.getElementById('update-empleado-tel-button'),
                    document.getElementById('update-empleado-empresa-button'),
                    document.getElementById('update-empleado-correo-button'),
                    document.getElementById('update-empleado-edad-button')
                ];

                inputs.forEach(input => { input.value = ''; input.disabled = true; });
                buttons.forEach(button => { button.disabled = true; });
                currentEmpleadoDocId = null;

                if (!noEmpleadoSearch) {
                    showMessage("Por favor, ingrese el número de empleado a buscar.");
                    return;
                }

                const empleado = await getDocumentById('empleados', noEmpleadoSearch);
                if (empleado) {
                    currentEmpleadoDocId = empleado.NO_EMPLEADO_PK; // Use PK for update
                    document.getElementById('modificar-empleado-nom').value = empleado.NOM_EMPLEADO;
                    document.getElementById('modificar-empleado-legajo').value = empleado.LEGAJO;
                    document.getElementById('modificar-empleado-dir').value = empleado.DIR_EMPLEADO;
                    document.getElementById('modificar-empleado-tel').value = empleado.TEL_EMPLEADO;
                    document.getElementById('modificar-empleado-empresa').value = empleado.EMPRESA_EMPLEADO;
                    document.getElementById('modificar-empleado-correo').value = empleado.CORREO_EMPLEADO;
                    document.getElementById('modificar-empleado-edad').value = empleado.EDAD;

                    inputs.forEach(input => { input.disabled = false; });
                    buttons.forEach(button => { button.disabled = false; });
                    showMessage("Empleado encontrado. Puede modificar los campos individualmente.");
                } else {
                    showMessage("Empleado no encontrado.");
                }
            });

            // Individual update listeners for Empleado
            document.getElementById('update-empleado-nom-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-nom').value.trim();
                if (!newValue) { showMessage("El nombre no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Nombre del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { NOM_EMPLEADO: newValue });
                    if (success) { showMessage("Nombre de Empleado actualizado."); }
                }
            });
            document.getElementById('update-empleado-legajo-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-legajo').value.trim();
                if (!newValue) { showMessage("El legajo no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Legajo del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { LEGAJO: newValue });
                    if (success) { showMessage("Legajo de Empleado actualizado."); }
                }
            });
            document.getElementById('update-empleado-dir-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-dir').value.trim();
                if (!newValue) { showMessage("La dirección no puede estar vacía."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Dirección del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { DIR_EMPLEADO: newValue });
                    if (success) { showMessage("Dirección de Empleado actualizada."); }
                }
            });
            document.getElementById('update-empleado-tel-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-tel').value.trim();
                if (!newValue) { showMessage("El teléfono no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Teléfono del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { TEL_EMPLEADO: newValue });
                    if (success) { showMessage("Teléfono de Empleado actualizado."); }
                }
            });
            document.getElementById('update-empleado-empresa-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-empresa').value.trim();
                if (!newValue) { showMessage("La empresa no puede estar vacía."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Empresa del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { EMPRESA_EMPLEADO: newValue });
                    if (success) { showMessage("Empresa de Empleado actualizada."); }
                }
            });
            document.getElementById('update-empleado-correo-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-correo').value.trim();
                if (!newValue) { showMessage("El correo no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Correo del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { CORREO_EMPLEADO: newValue });
                    if (success) { showMessage("Correo de Empleado actualizado."); }
                }
            });
            document.getElementById('update-empleado-edad-button').addEventListener('click', async () => {
                if (!currentEmpleadoDocId) { showMessage("Primero busque un empleado."); return; }
                const newValue = document.getElementById('modificar-empleado-edad').value.trim();
                if (!newValue || isNaN(parseInt(newValue))) { showMessage("La edad debe ser un número válido."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Edad del Empleado?");
                if (confirmed) {
                    const success = await updateDocument('empleados', currentEmpleadoDocId, { EDAD: parseInt(newValue) });
                    if (success) { showMessage("Edad de Empleado actualizada."); }
                }
            });

            document.getElementById('back-to-modificar-menu-from-empleado').addEventListener('click', () => showPage('modificar-menu'));

            // Modificar Vendedor
            let currentVendedorDocId = null; // This will store the ID_VENDEDOR_PK
            document.getElementById('search-modificar-vendedor').addEventListener('click', async () => {
                const idVendedorSearch = document.getElementById('modificar-vendedor-id-search').value.trim();
                const nombreVendedorInput = document.getElementById('modificar-vendedor-nombre');
                const telVendedorInput = document.getElementById('modificar-vendedor-tel');
                const updateNombreButton = document.getElementById('update-vendedor-nombre-button');
                const updateTelButton = document.getElementById('update-vendedor-tel-button');

                nombreVendedorInput.value = ''; nombreVendedorInput.disabled = true;
                telVendedorInput.value = ''; telVendedorInput.disabled = true;
                updateNombreButton.disabled = true;
                updateTelButton.disabled = true;
                currentVendedorDocId = null;

                if (!idVendedorSearch) {
                    showMessage("Por favor, ingrese el ID del vendedor a buscar.");
                    return;
                }

                const vendedor = await getDocumentById('vendedores', idVendedorSearch);
                if (vendedor) {
                    currentVendedorDocId = vendedor.ID_VENDEDOR_PK; // Use PK for update
                    nombreVendedorInput.value = vendedor.NOMBRE_VENDEDOR;
                    telVendedorInput.value = vendedor.TEL_VENDEDOR;
                    nombreVendedorInput.disabled = false;
                    telVendedorInput.disabled = false;
                    updateNombreButton.disabled = false;
                    updateTelButton.disabled = false;
                    showMessage("Vendedor encontrado. Puede modificar los campos individualmente.");
                } else {
                    showMessage("Vendedor no encontrado.");
                }
            });
            // Individual update listeners for Vendedor
            document.getElementById('update-vendedor-nombre-button').addEventListener('click', async () => {
                if (!currentVendedorDocId) { showMessage("Primero busque un vendedor."); return; }
                const newValue = document.getElementById('modificar-vendedor-nombre').value.trim();
                if (!newValue) { showMessage("El nombre no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Nombre del Vendedor?");
                if (confirmed) {
                    const success = await updateDocument('vendedores', currentVendedorDocId, { NOMBRE_VENDEDOR: newValue });
                    if (success) { showMessage("Nombre de Vendedor actualizado."); }
                }
            });
            document.getElementById('update-vendedor-tel-button').addEventListener('click', async () => {
                if (!currentVendedorDocId) { showMessage("Primero busque un vendedor."); return; }
                const newValue = document.getElementById('modificar-vendedor-tel').value.trim();
                if (!newValue) { showMessage("El teléfono no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Teléfono del Vendedor?");
                if (confirmed) {
                    const success = await updateDocument('vendedores', currentVendedorDocId, { TEL_VENDEDOR: newValue });
                    if (success) { showMessage("Teléfono de Vendedor actualizado."); }
                }
            });
            document.getElementById('back-to-modificar-menu-from-vendedor').addEventListener('click', () => showPage('modificar-menu'));

            // Modificar Cliente
            let currentClienteDocId = null; // This will store the ID_CLIENTE_PK
            document.getElementById('search-modificar-cliente').addEventListener('click', async () => {
                const idClienteSearch = document.getElementById('modificar-cliente-id-search').value.trim();
                const nombreClienteInput = document.getElementById('modificar-cliente-nombre');
                const direccionInput = document.getElementById('modificar-cliente-direccion');
                const telefonoInput = document.getElementById('modificar-cliente-telefono');
                const correoInput = document.getElementById('modificar-cliente-correo');
                const updateNombreButton = document.getElementById('update-cliente-nombre-button');
                const updateDireccionButton = document.getElementById('update-cliente-direccion-button');
                const updateTelefonoButton = document.getElementById('update-cliente-telefono-button');
                const updateCorreoButton = document.getElementById('update-cliente-correo-button');

                nombreClienteInput.value = ''; nombreClienteInput.disabled = true;
                direccionInput.value = ''; direccionInput.disabled = true;
                telefonoInput.value = ''; telefonoInput.disabled = true;
                correoInput.value = ''; correoInput.disabled = true;
                updateNombreButton.disabled = true;
                updateDireccionButton.disabled = true;
                updateTelefonoButton.disabled = true;
                updateCorreoButton.disabled = true;
                currentClienteDocId = null;

                if (!idClienteSearch) {
                    showMessage("Por favor, ingrese el ID del cliente a buscar.");
                    return;
                }

                const cliente = await getDocumentById('clientes', idClienteSearch);
                if (cliente) {
                    currentClienteDocId = cliente.ID_CLIENTE_PK; // Use PK for update
                    nombreClienteInput.value = cliente.NOMBRE_CLIENTE;
                    direccionInput.value = cliente.DIR_CLIENTE;
                    telefonoInput.value = cliente.TEL_CLIENTE;
                    correoInput.value = cliente.CORREO_CLIENTE;

                    nombreClienteInput.disabled = false;
                    direccionInput.disabled = false;
                    telefonoInput.disabled = false;
                    correoInput.disabled = false;
                    updateNombreButton.disabled = false;
                    updateDireccionButton.disabled = false;
                    updateTelefonoButton.disabled = false;
                    updateCorreoButton.disabled = false;
                    showMessage("Cliente encontrado. Puede modificar los campos individualmente.");
                } else {
                    showMessage("Cliente no encontrado.");
                }
            });
            // Individual update listeners for Cliente
            document.getElementById('update-cliente-nombre-button').addEventListener('click', async () => {
                if (!currentClienteDocId) { showMessage("Primero busque un cliente."); return; }
                const newValue = document.getElementById('modificar-cliente-nombre').value.trim();
                if (!newValue) { showMessage("El nombre no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Nombre del Cliente?");
                if (confirmed) {
                    const success = await updateDocument('clientes', currentClienteDocId, { NOMBRE_CLIENTE: newValue });
                    if (success) { showMessage("Nombre de Cliente actualizado."); }
                }
            });
            document.getElementById('update-cliente-direccion-button').addEventListener('click', async () => {
                if (!currentClienteDocId) { showMessage("Primero busque un cliente."); return; }
                const newValue = document.getElementById('modificar-cliente-direccion').value.trim();
                if (!newValue) { showMessage("La dirección no puede estar vacía."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Dirección del Cliente?");
                if (confirmed) {
                    const success = await updateDocument('clientes', currentClienteDocId, { DIR_CLIENTE: newValue });
                    if (success) { showMessage("Dirección de Cliente actualizada."); }
                }
            });
            document.getElementById('update-cliente-telefono-button').addEventListener('click', async () => {
                if (!currentClienteDocId) { showMessage("Primero busque un cliente."); return; }
                const newValue = document.getElementById('modificar-cliente-telefono').value.trim();
                if (!newValue) { showMessage("El teléfono no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Teléfono del Cliente?");
                if (confirmed) {
                    const success = await updateDocument('clientes', currentClienteDocId, { TEL_CLIENTE: newValue });
                    if (success) { showMessage("Teléfono de Cliente actualizado."); }
                }
            });
            document.getElementById('update-cliente-correo-button').addEventListener('click', async () => {
                if (!currentClienteDocId) { showMessage("Primero busque un cliente."); return; }
                const newValue = document.getElementById('modificar-cliente-correo').value.trim();
                if (!newValue) { showMessage("El correo no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Correo del Cliente?");
                if (confirmed) {
                    const success = await updateDocument('clientes', currentClienteDocId, { CORREO_CLIENTE: newValue });
                    if (success) { showMessage("Correo de Cliente actualizado."); }
                }
            });
            document.getElementById('back-to-modificar-menu-from-cliente').addEventListener('click', () => showPage('modificar-menu'));

            // Modificar Libro
            let currentLibroDocId = null; // This will store the ID_LIBRO_PK
            document.getElementById('search-modificar-libro').addEventListener('click', async () => {
                const idLibroSearch = document.getElementById('modificar-libro-id-search').value.trim();
                const tituloInput = document.getElementById('modificar-libro-titulo');
                const autorInput = document.getElementById('modificar-libro-autor');
                const editorialInput = document.getElementById('modificar-libro-editorial');
                const generoInput = document.getElementById('modificar-libro-genero');
                const updateTituloButton = document.getElementById('update-libro-titulo-button');
                const updateAutorButton = document.getElementById('update-libro-autor-button');
                const updateEditorialButton = document.getElementById('update-libro-editorial-button');
                const updateGeneroButton = document.getElementById('update-libro-genero-button');

                tituloInput.value = ''; tituloInput.disabled = true;
                autorInput.value = ''; autorInput.disabled = true;
                editorialInput.value = ''; editorialInput.disabled = true;
                generoInput.value = ''; generoInput.disabled = true;
                updateTituloButton.disabled = true;
                updateAutorButton.disabled = true;
                updateEditorialButton.disabled = true;
                updateGeneroButton.disabled = true;
                currentLibroDocId = null;

                if (!idLibroSearch) {
                    showMessage("Por favor, ingrese el ID del libro a buscar.");
                    return;
                }

                const libro = await getDocumentById('libros', idLibroSearch);
                if (libro) {
                    currentLibroDocId = libro.ID_LIBRO_PK; // Use PK for update
                    tituloInput.value = libro.TITULO_LIB;
                    autorInput.value = libro.AUTOR;
                    editorialInput.value = libro.EDITORIAL_LIBRO;
                    generoInput.value = libro.GENERO_LIBRO;

                    tituloInput.disabled = false;
                    autorInput.disabled = false;
                    editorialInput.disabled = false;
                    generoInput.disabled = false;
                    updateTituloButton.disabled = false;
                    updateAutorButton.disabled = false;
                    updateEditorialButton.disabled = false;
                    updateGeneroButton.disabled = false;
                    showMessage("Libro encontrado. Puede modificar los campos individualmente.");
                } else {
                    showMessage("Libro no encontrado.");
                }
            });
            // Individual update listeners for Libro
            document.getElementById('update-libro-titulo-button').addEventListener('click', async () => {
                if (!currentLibroDocId) { showMessage("Primero busque un libro."); return; }
                const newValue = document.getElementById('modificar-libro-titulo').value.trim();
                if (!newValue) { showMessage("El título no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Título del Libro?");
                if (confirmed) {
                    const success = await updateDocument('libros', currentLibroDocId, { TITULO_LIB: newValue });
                    if (success) { showMessage("Título de Libro actualizado."); }
                }
            });
            document.getElementById('update-libro-autor-button').addEventListener('click', async () => {
                if (!currentLibroDocId) { showMessage("Primero busque un libro."); return; }
                const newValue = document.getElementById('modificar-libro-autor').value.trim();
                if (!newValue) { showMessage("El autor no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Autor del Libro?");
                if (confirmed) {
                    const success = await updateDocument('libros', currentLibroDocId, { AUTOR: newValue });
                    if (success) { showMessage("Autor de Libro actualizado."); }
                }
            });
            document.getElementById('update-libro-editorial-button').addEventListener('click', async () => {
                if (!currentLibroDocId) { showMessage("Primero busque un libro."); return; }
                const newValue = document.getElementById('modificar-libro-editorial').value.trim();
                if (!newValue) { showMessage("La editorial no puede estar vacía."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Editorial del Libro?");
                if (confirmed) {
                    const success = await updateDocument('libros', currentLibroDocId, { EDITORIAL_LIBRO: newValue });
                    if (success) { showMessage("Editorial de Libro actualizada."); }
                }
            });
            document.getElementById('update-libro-genero-button').addEventListener('click', async () => {
                if (!currentLibroDocId) { showMessage("Primero busque un libro."); return; }
                const newValue = document.getElementById('modificar-libro-genero').value.trim();
                if (!newValue) { showMessage("El género no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Género del Libro?");
                if (confirmed) {
                    const success = await updateDocument('libros', currentLibroDocId, { GENERO_LIBRO: newValue });
                    if (success) { showMessage("Género de Libro actualizado."); }
                }
            });
            document.getElementById('back-to-modificar-menu-from-libro').addEventListener('click', () => showPage('modificar-menu'));

            // Modificar Visita
            let currentVisitaDocId = null; // This will store the ID_VISITA_PK
            document.getElementById('search-modificar-visita').addEventListener('click', async () => {
                const idVisitaSearch = document.getElementById('modificar-visita-id-search').value.trim();
                const fechaInput = document.getElementById('modificar-visita-fecha');
                const horaInput = document.getElementById('modificar-visita-hora');
                const resInput = document.getElementById('modificar-visita-res');
                const vendedorFkInput = document.getElementById('modificar-visita-vendedor-fk');
                const empleadoFkInput = document.getElementById('modificar-visita-empleado-fk');
                const updateFechaButton = document.getElementById('update-visita-fecha-button');
                const updateHoraButton = document.getElementById('update-visita-hora-button');
                const updateResButton = document.getElementById('update-visita-res-button');
                const updateVendedorFkButton = document.getElementById('update-visita-vendedor-fk-button');
                const updateEmpleadoFkButton = document.getElementById('update-visita-empleado-fk-button');

                fechaInput.value = ''; fechaInput.disabled = true;
                horaInput.value = ''; horaInput.disabled = true;
                resInput.value = ''; resInput.disabled = true;
                vendedorFkInput.value = ''; vendedorFkInput.disabled = true;
                empleadoFkInput.value = ''; empleadoFkInput.disabled = true;
                updateFechaButton.disabled = true;
                updateHoraButton.disabled = true;
                updateResButton.disabled = true;
                updateVendedorFkButton.disabled = true;
                updateEmpleadoFkButton.disabled = true;
                currentVisitaDocId = null;

                if (!idVisitaSearch) {
                    showMessage("Por favor, ingrese el ID de la visita a buscar.");
                    return;
                }

                const visita = await getDocumentById('visitas', idVisitaSearch);
                if (visita) {
                    currentVisitaDocId = visita.ID_VISITA_PK; // Use PK for update
                    fechaInput.value = visita.FECHA_VISITA;
                    horaInput.value = visita.HORA_VISITA;
                    resInput.value = visita.RES_VISITA;
                    vendedorFkInput.value = visita.ID_VENDEDOR_FK;
                    empleadoFkInput.value = visita.NO_EMPLEADO_FK;

                    fechaInput.disabled = false;
                    horaInput.disabled = false;
                    resInput.disabled = false;
                    vendedorFkInput.disabled = false;
                    empleadoFkInput.disabled = false;
                    updateFechaButton.disabled = false;
                    updateHoraButton.disabled = false;
                    updateResButton.disabled = false;
                    updateVendedorFkButton.disabled = false;
                    updateEmpleadoFkButton.disabled = false;
                    showMessage("Visita encontrada. Puede modificar los campos individualmente.");
                } else {
                    showMessage("Visita no encontrada.");
                }
            });
            // Individual update listeners for Visita
            document.getElementById('update-visita-fecha-button').addEventListener('click', async () => {
                if (!currentVisitaDocId) { showMessage("Primero busque una visita."); return; }
                const newValue = document.getElementById('modificar-visita-fecha').value.trim();
                if (!newValue) { showMessage("La fecha no puede estar vacía."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Fecha de la Visita?");
                if (confirmed) {
                    const success = await updateDocument('visitas', currentVisitaDocId, { FECHA_VISITA: newValue });
                    if (success) { showMessage("Fecha de Visita actualizada."); }
                }
            });
            document.getElementById('update-visita-hora-button').addEventListener('click', async () => {
                if (!currentVisitaDocId) { showMessage("Primero busque una visita."); return; }
                const newValue = document.getElementById('modificar-visita-hora').value.trim();
                if (!newValue) { showMessage("La hora no puede estar vacía."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar la Hora de la Visita?");
                if (confirmed) {
                    const success = await updateDocument('visitas', currentVisitaDocId, { HORA_VISITA: newValue });
                    if (success) { showMessage("Hora de Visita actualizada."); }
                }
            });
            document.getElementById('update-visita-res-button').addEventListener('click', async () => {
                if (!currentVisitaDocId) { showMessage("Primero busque una visita."); return; }
                const newValue = document.getElementById('modificar-visita-res').value.trim();
                if (!newValue) { showMessage("El resultado no puede estar vacío."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Resultado de la Visita?");
                if (confirmed) {
                    const success = await updateDocument('visitas', currentVisitaDocId, { RES_VISITA: newValue });
                    if (success) { showMessage("Resultado de Visita actualizado."); }
                }
            });
            document.getElementById('update-visita-vendedor-fk-button').addEventListener('click', async () => {
                if (!currentVisitaDocId) { showMessage("Primero busque una visita."); return; }
                const newValue = document.getElementById('modificar-visita-vendedor-fk').value.trim();
                if (!newValue || isNaN(parseInt(newValue))) { showMessage("El ID de Vendedor debe ser un número válido."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el ID de Vendedor de la Visita?");
                if (confirmed) {
                    const success = await updateDocument('visitas', currentVisitaDocId, { ID_VENDEDOR_FK: parseInt(newValue) });
                    if (success) { showMessage("ID de Vendedor de Visita actualizado."); }
                }
            });
            document.getElementById('update-visita-empleado-fk-button').addEventListener('click', async () => {
                if (!currentVisitaDocId) { showMessage("Primero busque una visita."); return; }
                const newValue = document.getElementById('modificar-visita-empleado-fk').value.trim();
                if (!newValue || isNaN(parseInt(newValue))) { showMessage("El Número de Empleado debe ser un número válido."); return; }
                const confirmed = await showConfirm("¿Está seguro de que desea actualizar el Número de Empleado de la Visita?");
                if (confirmed) {
                    const success = await updateDocument('visitas', currentVisitaDocId, { NO_EMPLEADO_FK: parseInt(newValue) });
                    if (success) { showMessage("Número de Empleado de Visita actualizado."); }
                }
            });
            document.getElementById('back-to-modificar-menu-from-visita').addEventListener('click', () => showPage('modificar-menu'));


            // Consulta Menu
            document.getElementById('btn-consulta-empleado').addEventListener('click', () => { clearInputs('consulta-empleado-page'); document.getElementById('consulta-empleado-results').innerHTML = ''; showPage('consulta-empleado-page'); });
            document.getElementById('btn-consulta-vendedor').addEventListener('click', () => { clearInputs('consulta-vendedor-page'); document.getElementById('consulta-vendedor-results').innerHTML = ''; showPage('consulta-vendedor-page'); });
            document.getElementById('btn-consulta-cliente').addEventListener('click', () => { clearInputs('consulta-cliente-page'); document.getElementById('consulta-cliente-results').innerHTML = ''; showPage('consulta-cliente-page'); });
            document.getElementById('btn-consulta-libro').addEventListener('click', () => { clearInputs('consulta-libro-page'); document.getElementById('consulta-libro-results').innerHTML = ''; showPage('consulta-libro-page'); });
            document.getElementById('btn-consulta-visita').addEventListener('click', () => { clearInputs('consulta-visita-page'); document.getElementById('consulta-visita-results').innerHTML = ''; showPage('consulta-visita-page'); });
            document.getElementById('btn-consulta-venta').addEventListener('click', () => { clearInputs('consulta-venta-page'); document.getElementById('consulta-venta-results').innerHTML = ''; showPage('consulta-venta-page'); });
            document.getElementById('back-to-main-menu-from-consulta').addEventListener('click', () => showPage('main-menu'));

            // Consulta Empleado
            document.getElementById('search-consulta-empleado').addEventListener('click', async () => {
                const noEmpleadoSearch = document.getElementById('consulta-empleado-no-search').value.trim();
                const resultsContainer = document.getElementById('consulta-empleado-results');
                let empleados;
                if (noEmpleadoSearch) {
                    empleados = (await getDocuments('empleados', 'NO_EMPLEADO_PK', noEmpleadoSearch)).filter(Boolean);
                } else {
                    empleados = await getDocuments('empleados');
                }
                const headers = ['id', 'NO_EMPLEADO_PK', 'NOM_EMPLEADO', 'LEGAJO', 'DIR_EMPLEADO', 'TEL_EMPLEADO', 'EMPRESA_EMPLEADO', 'CORREO_EMPLEADO', 'EDAD'];
                renderTable(resultsContainer, empleados, headers);
            });
            document.getElementById('back-to-consulta-menu-from-empleado').addEventListener('click', () => showPage('consulta-menu'));

            // Consulta Vendedor
            document.getElementById('search-consulta-vendedor').addEventListener('click', async () => {
                const idVendedorSearch = document.getElementById('consulta-vendedor-id-search').value.trim();
                const resultsContainer = document.getElementById('consulta-vendedor-results');
                let vendedores;
                if (idVendedorSearch) {
                    vendedores = (await getDocuments('vendedores', 'ID_VENDEDOR_PK', idVendedorSearch)).filter(Boolean);
                } else {
                    vendedores = await getDocuments('vendedores');
                }
                const headers = ['id', 'ID_VENDEDOR_PK', 'NOMBRE_VENDEDOR', 'TEL_VENDEDOR'];
                renderTable(resultsContainer, vendedores, headers);
            });
            document.getElementById('back-to-consulta-menu-from-vendedor').addEventListener('click', () => showPage('consulta-menu'));

            // Consulta Cliente
            document.getElementById('search-consulta-cliente').addEventListener('click', async () => {
                const idClienteSearch = document.getElementById('consulta-cliente-id-search').value.trim();
                const resultsContainer = document.getElementById('consulta-cliente-results');
                let clientes;
                if (idClienteSearch) {
                    clientes = (await getDocuments('clientes', 'ID_CLIENTE_PK', idClienteSearch)).filter(Boolean);
                } else {
                    clientes = await getDocuments('clientes');
                }
                const headers = ['id', 'ID_CLIENTE_PK', 'NOMBRE_CLIENTE', 'DIR_CLIENTE', 'TEL_CLIENTE', 'CORREO_CLIENTE'];
                renderTable(resultsContainer, clientes, headers);
            });
            document.getElementById('back-to-consulta-menu-from-cliente').addEventListener('click', () => showPage('consulta-menu'));

            // Consulta Libro
            document.getElementById('search-consulta-libro').addEventListener('click', async () => {
                const idLibroSearch = document.getElementById('consulta-libro-id-search').value.trim();
                const resultsContainer = document.getElementById('consulta-libro-results');
                let libros;
                if (idLibroSearch) {
                    libros = (await getDocuments('libros', 'ID_LIBRO_PK', idLibroSearch)).filter(Boolean);
                } else {
                    libros = await getDocuments('libros');
                }
                const headers = ['id', 'ID_LIBRO_PK', 'TITULO_LIB', 'AUTOR', 'EDITORIAL_LIBRO', 'GENERO_LIBRO'];
                renderTable(resultsContainer, libros, headers);
            });
            document.getElementById('back-to-consulta-menu-from-libro').addEventListener('click', () => showPage('consulta-menu'));

            // Consulta Visita
            document.getElementById('search-consulta-visita').addEventListener('click', async () => {
                const idVisitaSearch = document.getElementById('consulta-visita-id-search').value.trim();
                const resultsContainer = document.getElementById('consulta-visita-results');
                let visitas;
                if (idVisitaSearch) {
                    visitas = (await getDocuments('visitas', 'ID_VISITA_PK', idVisitaSearch)).filter(Boolean);
                } else {
                    visitas = await getDocuments('visitas');
                }
                const headers = ['id', 'ID_VISITA_PK', 'FECHA_VISITA', 'HORA_VISITA', 'RES_VISITA', 'ID_VENDEDOR_FK', 'NO_EMPLEADO_FK'];
                renderTable(resultsContainer, visitas, headers);
            });
            document.getElementById('back-to-consulta-menu-from-visita').addEventListener('click', () => showPage('consulta-menu'));

            // Consulta Venta
            document.getElementById('search-consulta-venta').addEventListener('click', async () => {
                const idVentaSearch = document.getElementById('consulta-venta-id-search').value.trim();
                const resultsContainer = document.getElementById('consulta-venta-results');
                let ventas;
                if (idVentaSearch) {
                    ventas = (await getDocuments('ventas', 'ID_VENTA_PK', idVentaSearch)).filter(Boolean);
                } else {
                    ventas = await getDocuments('ventas');
                }
                const headers = ['id', 'ID_VENTA_PK', 'FECHA_VENTA', 'HORA_VENTA', 'LIBROS_VENTA', 'ID_VISITA_FK'];
                renderTable(resultsContainer, ventas, headers);
            });
            document.getElementById('back-to-consulta-menu-from-venta').addEventListener('click', () => showPage('consulta-menu'));


            // Baja Menu
            document.getElementById('btn-baja-empleado').addEventListener('click', () => { clearInputs('baja-empleado-page'); showPage('baja-empleado-page'); });
            document.getElementById('btn-baja-vendedor').addEventListener('click', () => { clearInputs('baja-vendedor-page'); showPage('baja-vendedor-page'); });
            document.getElementById('btn-baja-cliente').addEventListener('click', () => { clearInputs('baja-cliente-page'); showPage('baja-cliente-page'); });
            document.getElementById('btn-baja-libro').addEventListener('click', () => { clearInputs('baja-libro-page'); showPage('baja-libro-page'); });
            document.getElementById('btn-baja-visita').addEventListener('click', () => { clearInputs('baja-visita-page'); showPage('baja-visita-page'); });
            document.getElementById('back-to-main-menu-from-baja').addEventListener('click', () => showPage('main-menu'));

            // Baja Empleado
            document.getElementById('delete-empleado-button').addEventListener('click', async () => {
                const noEmpleadoToDelete = document.getElementById('baja-empleado-no').value.trim();
                if (!noEmpleadoToDelete) {
                    showMessage("Por favor, ingrese el número de empleado a eliminar.");
                    return;
                }

                const confirmed = await showConfirm(`¿Está seguro de que desea eliminar al empleado con No. ${noEmpleadoToDelete}?`);
                if (confirmed) {
                    const success = await deleteDocument('empleados', noEmpleadoToDelete); // Delete by PK as doc ID
                    if (success) {
                        showMessage("Empleado eliminado exitosamente.");
                        clearInputs('baja-empleado-page');
                    } else {
                        showMessage("Empleado no encontrado o error al eliminar.");
                    }
                }
            });
            document.getElementById('back-to-baja-menu-from-empleado').addEventListener('click', () => showPage('baja-menu'));

            // Baja Vendedor
            document.getElementById('delete-vendedor-button').addEventListener('click', async () => {
                const idVendedorToDelete = document.getElementById('baja-vendedor-id').value.trim();
                if (!idVendedorToDelete) {
                    showMessage("Por favor, ingrese el ID del vendedor a eliminar.");
                    return;
                }

                const confirmed = await showConfirm(`¿Está seguro de que desea eliminar al vendedor con ID ${idVendedorToDelete}?`);
                if (confirmed) {
                    const success = await deleteDocument('vendedores', idVendedorToDelete); // Delete by PK as doc ID
                    if (success) {
                        showMessage("Vendedor eliminado exitosamente.");
                        clearInputs('baja-vendedor-page');
                    } else {
                        showMessage("Vendedor no encontrado o error al eliminar.");
                    }
                }
            });
            document.getElementById('back-to-baja-menu-from-vendedor').addEventListener('click', () => showPage('baja-menu'));

            // Baja Cliente
            document.getElementById('delete-cliente-button').addEventListener('click', async () => {
                const idClienteToDelete = document.getElementById('baja-cliente-id').value.trim();
                if (!idClienteToDelete) {
                    showMessage("Por favor, ingrese el ID del cliente a eliminar.");
                    return;
                }

                const confirmed = await showConfirm(`¿Está seguro de que desea eliminar al cliente con ID ${idClienteToDelete}?`);
                if (confirmed) {
                    const success = await deleteDocument('clientes', idClienteToDelete); // Delete by PK as doc ID
                    if (success) {
                        showMessage("Cliente eliminado exitosamente.");
                        clearInputs('baja-cliente-page');
                    } else {
                        showMessage("Cliente no encontrado o error al eliminar.");
                    }
                }
            });
            document.getElementById('back-to-baja-menu-from-cliente').addEventListener('click', () => showPage('baja-menu'));

            // Baja Libro
            document.getElementById('delete-libro-button').addEventListener('click', async () => {
                const idLibroToDelete = document.getElementById('baja-libro-id').value.trim();
                if (!idLibroToDelete) {
                    showMessage("Por favor, ingrese el ID del libro a eliminar.");
                    return;
                }

                const confirmed = await showConfirm(`¿Está seguro de que desea eliminar el libro con ID ${idLibroToDelete}?`);
                if (confirmed) {
                    const success = await deleteDocument('libros', idLibroToDelete); // Delete by PK as doc ID
                    if (success) {
                        showMessage("Libro eliminado exitosamente.");
                        clearInputs('baja-libro-page');
                    } else {
                        showMessage("Libro no encontrado o error al eliminar.");
                    }
                }
            });
            document.getElementById('back-to-baja-menu-from-libro').addEventListener('click', () => showPage('baja-menu'));

            // Baja Visita
            document.getElementById('delete-visita-button').addEventListener('click', async () => {
                const idVisitaToDelete = document.getElementById('baja-visita-id').value.trim();
                if (!idVisitaToDelete) {
                    showMessage("Por favor, ingrese el ID de la visita a eliminar.");
                    return;
                }

                const confirmed = await showConfirm(`¿Está seguro de que desea eliminar la visita con ID ${idVisitaToDelete}?`);
                if (confirmed) {
                    const success = await deleteDocument('visitas', idVisitaToDelete); // Delete by PK as doc ID
                    if (success) {
                        showMessage("Visita eliminada exitosamente.");
                        clearInputs('baja-visita-page');
                    } else {
                        showMessage("Visita no encontrada o error al eliminar.");
                    }
                }
            });
            document.getElementById('back-to-baja-menu-from-visita').addEventListener('click', () => showPage('baja-menu'));
        });
    </script>
</body>
</html>
